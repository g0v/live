"use strict";angular.module("liveApp",["liveApp.filters","ngCookies","ngResource","ngSanitize","ngRoute","firebase","ui.utils","ui.bootstrap","angular-md5"]).config(["$routeProvider",function(a){a.when("/addLink",{templateUrl:"views/addLink.html",controller:"AddLinkCtrl"}).otherwise({redirectTo:"/addLink"})}]),angular.module("liveApp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]).filter("reverse",function(){function a(a){var b,c=[];if(a)if(angular.isArray(a))c=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}return function(b){return a(b).slice().reverse()}}),angular.module("liveApp").controller("AddLinkCtrl",["$scope","$firebase","md5",function(a,b){a.prompt="已收集的連結",a.updatePrompt=function(){a.prompt=0==a.linkSearch.$.length?"已收集的連結":"網址相似的連結"};var c=new Firebase("https://livelink-submission.firebaseio.com/links/");a.links=b(c),a.alerts=[],a.addAlert=function(b,c){a.alerts.push({type:b,msg:c})},a.closeAlert=function(b){a.alerts.splice(b,1)},a.linkPrompt="",a.is_valid_url=function(a){a=String(a);var b=a.match(/^(ht|f)tps?:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/);return null!=b?!0:!1},a.addLink=function(){a.is_valid_url(a.linkSearch.$)?(a.links.$add({url:a.linkSearch.$,added_at:(new Date).getTime()}),a.addAlert("success","我們已經收到網址"+a.linkSearch.$),a.linkSearch.$="",a.prompt="已收集的連結"):a.addAlert("danger","網址格式有誤！")}}]),angular.module("liveApp").controller("ManageLinksCtrl",["$scope","$firebase","md5",function(a,b){var c=new Firebase("https://livelink.firebaseio.com/index/");a.index=b(c),a.getLinks=function(a){var c=new Firebase("https://livelink.firebaseio.com/links/"+a),d=b(c);return d}}]);